{% extends "base.html" %}

{% block title %}Arbeitszeit bearbeiten{% endblock %}

{% block content %}
    <div class="mt-4 p-4">
        <h2 class="text-2xl font-bold text-green-600 mb-4">Arbeitszeit für {{ worktime.employee.name }} bearbeiten</h2>
        <form action="/edit_worktime/{{ worktime.id }}" method="post" class="bg-white p-6 rounded-lg shadow-md" onsubmit="return validateForm()">
            {{ form.hidden_tag() }}
            <div class="mb-6">
                {{ form.date.label(class="block text-sm font-medium text-green-500 mb-2") }}
                {{ form.date(class="mt-1 block w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500") }}
            </div>

            <div id="start_time_field" class="mb-6">
                {{ form.start_time.label(class="block text-sm font-medium text-green-500 mb-2") }}
                {{ form.start_time(class="mt-1 block w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500") }}
            </div>

            <div id="end_time_field" class="mb-6">
                {{ form.end_time.label(class="block text-sm font-medium text-green-500 mb-2") }}
                {{ form.end_time(class="mt-1 block w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500") }}
            </div>

            <div class="mb-6">
                {{ form.status.label(class="block text-sm font-medium text-green-500 mb-2") }}
                {{ form.status(class="mt-1 block w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500") }}
            </div>

            <div class="mb-6">
                {{ form.comment.label(class="block text-sm font-medium text-green-500 mb-2") }}
                {{ form.comment(class="mt-1 block w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500", rows="4") }}
            </div>

            <div class="flex flex-col sm:flex-row justify-between space-y-4 sm:space-y-0 sm:space-x-4">
                {{ form.submit(class="bg-green-500 text-white py-3 px-6 rounded-lg shadow-md hover:bg-green-600 transition duration-300 w-full sm:w-auto text-center") }}
                <a href="/dashboard" class="bg-red-500 text-white py-3 px-6 rounded-lg shadow-md hover:bg-red-600 transition duration-300 w-full sm:w-auto text-center">Zurück zur Übersicht</a>
            </div>
        </form>
    </div>

    <script>
        function validateForm() {
            const status = document.getElementById('status').value;
            const startTimeField = document.getElementById('start_time');
            const endTimeField = document.getElementById('end_time');

            if (status !== 'Holiday' && status !== 'Ill' && status !== 'Absent') {
                if (!startTimeField.value || !endTimeField.value) {
                    alert('Bitte geben Sie Start- und Endzeit an.');
                    return false;
                }
            }

            return true;
        }

        // Initialize time fields visibility based on default status
        toggleTimeFields();
    </script>
{% endblock %}
